2025-10-29 15:31:03 - data_processing - ERROR - __main__:280 - ❌ Pipeline failed: [Errno 2] No such file or directory: '../../data_collection/data/btc_4h_20251028.parquet'
2025-10-29 15:31:03 - data_processing - ERROR - __main__:281 - Full traceback:
Traceback (most recent call last):
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 244, in __main__
    df_h4, df_d1, df_w1 = load_all_data()
                          ~~~~~~~~~~~~~^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/data/load_data.py", line 27, in load_all_data
    df_h4 = load_4h_data()
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/data/load_data.py", line 12, in load_4h_data
    df = load_data('4h')
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/data/load_data.py", line 6, in load_data
    df = pd.read_parquet(
        f'../../data_collection/data/btc_{file_name}_20251028.parquet')
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/io/parquet.py", line 669, in read_parquet
    return impl.read(
           ~~~~~~~~~^
        path,
        ^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/io/parquet.py", line 258, in read
    path_or_handle, handles, filesystem = _get_path_or_handle(
                                          ~~~~~~~~~~~~~~~~~~~^
        path,
        ^^^^^
    ...<2 lines>...
        mode="rb",
        ^^^^^^^^^^
    )
    ^
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/io/parquet.py", line 141, in _get_path_or_handle
    handles = get_handle(
        path_or_handle, mode, is_text=False, storage_options=storage_options
    )
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/io/common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
FileNotFoundError: [Errno 2] No such file or directory: '../../data_collection/data/btc_4h_20251028.parquet'
2025-10-29 15:31:41 - data_processing - ERROR - __main__:280 - ❌ Pipeline failed: [Errno 2] No such file or directory: '../data_collection/data/btc_4h_20251028.parquet'
2025-10-29 15:31:41 - data_processing - ERROR - __main__:281 - Full traceback:
Traceback (most recent call last):
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 244, in __main__
    df_h4, df_d1, df_w1 = load_all_data()
                          ~~~~~~~~~~~~~^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/data/load_data.py", line 27, in load_all_data
    df_h4 = load_4h_data()
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/data/load_data.py", line 12, in load_4h_data
    df = load_data('4h')
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/data/load_data.py", line 6, in load_data
    df = pd.read_parquet(
        f'../data_collection/data/btc_{file_name}_20251028.parquet')
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/io/parquet.py", line 669, in read_parquet
    return impl.read(
           ~~~~~~~~~^
        path,
        ^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/io/parquet.py", line 258, in read
    path_or_handle, handles, filesystem = _get_path_or_handle(
                                          ~~~~~~~~~~~~~~~~~~~^
        path,
        ^^^^^
    ...<2 lines>...
        mode="rb",
        ^^^^^^^^^^
    )
    ^
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/io/parquet.py", line 141, in _get_path_or_handle
    handles = get_handle(
        path_or_handle, mode, is_text=False, storage_options=storage_options
    )
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/io/common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
FileNotFoundError: [Errno 2] No such file or directory: '../data_collection/data/btc_4h_20251028.parquet'
2025-10-29 15:32:48 - data_processing - ERROR - __main__:280 - ❌ Pipeline failed: 'close'
2025-10-29 15:32:48 - data_processing - ERROR - __main__:281 - Full traceback:
Traceback (most recent call last):
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 248, in __main__
    df_h4, df_d1, df_w1 = calculate_indicators_on_all_data(df_h4, df_d1, df_w1)
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 65, in calculate_indicators_on_all_data
    df_h4 = calculate_all_indicators(df_h4)
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/features/indicators.py", line 18, in calculate_all_indicators
    data = transform_ichimoku_features(data)
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/features/ichimoku.py", line 93, in transform_ichimoku_features
    data = normalize_ichimoku(data)
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/features/ichimoku.py", line 52, in normalize_ichimoku
    normalized_val = (data['close'] / data[line_col]) - 1
                      ~~~~^^^^^^^^^
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/core/frame.py", line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'close'
2025-10-29 15:34:36 - data_processing - ERROR - __main__:280 - ❌ Pipeline failed: 'high'
2025-10-29 15:34:36 - data_processing - ERROR - __main__:281 - Full traceback:
Traceback (most recent call last):
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'high'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 248, in __main__
    df_h4, df_d1, df_w1 = calculate_indicators_on_all_data(df_h4, df_d1, df_w1)
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 65, in calculate_indicators_on_all_data
    df_h4 = calculate_all_indicators(df_h4)
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/features/indicators.py", line 19, in calculate_all_indicators
    data = transform_atr_features(data)
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/features/atr.py", line 41, in transform_atr_features
    data = calculate_atr(data)
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/features/atr.py", line 8, in calculate_atr
    high = data['high']
           ~~~~^^^^^^^^
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/core/frame.py", line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'high'
2025-10-29 15:38:08 - data_processing - ERROR - __main__:280 - ❌ Pipeline failed: 'close'
2025-10-29 15:38:08 - data_processing - ERROR - __main__:281 - Full traceback:
Traceback (most recent call last):
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 248, in __main__
    df_h4, df_d1, df_w1 = calculate_indicators_on_all_data(df_h4, df_d1, df_w1)
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 65, in calculate_indicators_on_all_data
    df_h4 = calculate_all_indicators(df_h4)
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/features/indicators.py", line 19, in calculate_all_indicators
    data = transform_atr_features(data)
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/features/atr.py", line 42, in transform_atr_features
    data = normalize_atr(data)
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/features/atr.py", line 20, in normalize_atr
    close = data['close']
            ~~~~^^^^^^^^^
KeyError: 'close'
2025-10-29 15:38:34 - data_processing - ERROR - __main__:280 - ❌ Pipeline failed: 'numpy.ndarray' object has no attribute 'replace'
2025-10-29 15:38:34 - data_processing - ERROR - __main__:281 - Full traceback:
Traceback (most recent call last):
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 248, in __main__
    df_h4, df_d1, df_w1 = calculate_indicators_on_all_data(df_h4, df_d1, df_w1)
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 65, in calculate_indicators_on_all_data
    df_h4 = calculate_all_indicators(df_h4)
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/features/indicators.py", line 19, in calculate_all_indicators
    data = transform_atr_features(data)
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/features/atr.py", line 41, in transform_atr_features
    data = normalize_atr(data)
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/features/atr.py", line 25, in normalize_atr
    0).replace([np.inf, -np.inf], 0)
       ^^^^^^^
AttributeError: 'numpy.ndarray' object has no attribute 'replace'
2025-10-29 15:40:22 - data_processing - ERROR - __main__:280 - ❌ Pipeline failed: 'close'
2025-10-29 15:40:22 - data_processing - ERROR - __main__:281 - Full traceback:
Traceback (most recent call last):
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 248, in __main__
    df_h4, df_d1, df_w1 = calculate_indicators_on_all_data(df_h4, df_d1, df_w1)
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 65, in calculate_indicators_on_all_data
    df_h4 = calculate_all_indicators(df_h4)
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/features/indicators.py", line 20, in calculate_all_indicators
    data = transform_bollinger_bands_features(data)
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/features/bollinger_bands.py", line 49, in transform_bollinger_bands_features
    data = normalize_bollinger_bands(data)
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/features/bollinger_bands.py", line 26, in normalize_bollinger_bands
    close = data['close']
            ~~~~^^^^^^^^^
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/core/frame.py", line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'close'
2025-10-29 15:41:53 - data_processing - ERROR - __main__:280 - ❌ Pipeline failed: 'H4_lags'
2025-10-29 15:41:53 - data_processing - ERROR - __main__:281 - Full traceback:
Traceback (most recent call last):
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 257, in __main__
    A3 = combine_timeframe_and_lag_features(A2, h4_lags, 'H4', 'H4_lags')
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 131, in combine_timeframe_and_lag_features
    lagged_data = combine_timeframe_data(base_data, lag_data, base_timeframe, lag_timeframe)
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/time/time_align.py", line 48, in combine_timeframe_data
    aligned_data = align_timeframe_data(base_data, target_data, base_timeframe,
                                        target_timeframe)
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/time/time_align.py", line 23, in align_timeframe_data
    offset = timeframe_offsets[target_timeframe]
             ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
KeyError: 'H4_lags'
2025-10-29 15:47:56 - data_processing.validation.feature_validation - ERROR - validate_filtered_features:92 - ❌ A4_filtered contains 4009800 NaN values in columns: {'MA_7_norm_lag_1': np.int64(9780), 'close_vs_lagging_span_pct_lag_7': np.int64(9780), 'is_doji_lag_7': np.int64(9780), 'is_engulfing_lag_7': np.int64(9780), 'is_hangingman_lag_7': np.int64(9780), 'is_hammer_lag_7': np.int64(9780), 'band_width_pct_lag_7': np.int64(9780), 'band_width_lag_7': np.int64(9780), 'ATR_norm_ma_lag_7': np.int64(9780), 'ATR_norm_lag_7': np.int64(9780)}
2025-10-29 15:47:56 - data_processing - ERROR - log_validation_result:165 - ❌ Filtered Data validation failed
2025-10-29 15:47:56 - data_processing - ERROR - __main__:282 - ❌ Pipeline failed: A4_filtered contains 4009800 NaN values in columns: {'MA_7_norm_lag_1': np.int64(9780), 'close_vs_lagging_span_pct_lag_7': np.int64(9780), 'is_doji_lag_7': np.int64(9780), 'is_engulfing_lag_7': np.int64(9780), 'is_hangingman_lag_7': np.int64(9780), 'is_hammer_lag_7': np.int64(9780), 'band_width_pct_lag_7': np.int64(9780), 'band_width_lag_7': np.int64(9780), 'ATR_norm_ma_lag_7': np.int64(9780), 'ATR_norm_lag_7': np.int64(9780)}
2025-10-29 15:47:56 - data_processing - ERROR - __main__:283 - Full traceback:
Traceback (most recent call last):
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 266, in __main__
    validate_filtered_data(A0_filtered, A1_filtered, A2_filtered,
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                           A3_filtered, A4_filtered, A5_filtered)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 187, in validate_filtered_data
    validate_filtered_features(A4_filtered, "A4_filtered")
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/validation/feature_validation.py", line 93, in validate_filtered_features
    raise ValueError(error_msg)
ValueError: A4_filtered contains 4009800 NaN values in columns: {'MA_7_norm_lag_1': np.int64(9780), 'close_vs_lagging_span_pct_lag_7': np.int64(9780), 'is_doji_lag_7': np.int64(9780), 'is_engulfing_lag_7': np.int64(9780), 'is_hangingman_lag_7': np.int64(9780), 'is_hammer_lag_7': np.int64(9780), 'band_width_pct_lag_7': np.int64(9780), 'band_width_lag_7': np.int64(9780), 'ATR_norm_ma_lag_7': np.int64(9780), 'ATR_norm_lag_7': np.int64(9780)}
2025-10-29 15:52:07 - data_processing.validation.feature_validation - ERROR - validate_filtered_features:92 - ❌ A4_filtered contains 4009800 NaN values in columns: {'MA_7_norm_lag_1': np.int64(9780), 'close_vs_lagging_span_pct_lag_7': np.int64(9780), 'is_doji_lag_7': np.int64(9780), 'is_engulfing_lag_7': np.int64(9780), 'is_hangingman_lag_7': np.int64(9780), 'is_hammer_lag_7': np.int64(9780), 'band_width_pct_lag_7': np.int64(9780), 'band_width_lag_7': np.int64(9780), 'ATR_norm_ma_lag_7': np.int64(9780), 'ATR_norm_lag_7': np.int64(9780)}
2025-10-29 15:52:07 - data_processing - ERROR - log_validation_result:165 - ❌ Filtered Data validation failed
2025-10-29 15:52:07 - data_processing - ERROR - __main__:282 - ❌ Pipeline failed: A4_filtered contains 4009800 NaN values in columns: {'MA_7_norm_lag_1': np.int64(9780), 'close_vs_lagging_span_pct_lag_7': np.int64(9780), 'is_doji_lag_7': np.int64(9780), 'is_engulfing_lag_7': np.int64(9780), 'is_hangingman_lag_7': np.int64(9780), 'is_hammer_lag_7': np.int64(9780), 'band_width_pct_lag_7': np.int64(9780), 'band_width_lag_7': np.int64(9780), 'ATR_norm_ma_lag_7': np.int64(9780), 'ATR_norm_lag_7': np.int64(9780)}
2025-10-29 15:52:07 - data_processing - ERROR - __main__:283 - Full traceback:
Traceback (most recent call last):
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 266, in __main__
    validate_filtered_data(A0_filtered, A1_filtered, A2_filtered,
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                           A3_filtered, A4_filtered, A5_filtered)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 187, in validate_filtered_data
    validate_filtered_features(A4_filtered, "A4_filtered")
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/validation/feature_validation.py", line 93, in validate_filtered_features
    raise ValueError(error_msg)
ValueError: A4_filtered contains 4009800 NaN values in columns: {'MA_7_norm_lag_1': np.int64(9780), 'close_vs_lagging_span_pct_lag_7': np.int64(9780), 'is_doji_lag_7': np.int64(9780), 'is_engulfing_lag_7': np.int64(9780), 'is_hangingman_lag_7': np.int64(9780), 'is_hammer_lag_7': np.int64(9780), 'band_width_pct_lag_7': np.int64(9780), 'band_width_lag_7': np.int64(9780), 'ATR_norm_ma_lag_7': np.int64(9780), 'ATR_norm_lag_7': np.int64(9780)}
2025-10-29 16:11:09 - data_processing.validation.feature_validation - ERROR - validate_filtered_features:109 - ❌ A4_filtered contains 4005700 NaN values in columns: {'MA_7_norm_lag_1': np.int64(9780), 'close_vs_lagging_span_pct_lag_7': np.int64(9780), 'is_doji_lag_7': np.int64(9780), 'is_engulfing_lag_7': np.int64(9780), 'is_hangingman_lag_7': np.int64(9780), 'is_hammer_lag_7': np.int64(9780), 'band_width_pct_lag_7': np.int64(9780), 'band_width_lag_7': np.int64(9780), 'ATR_norm_ma_lag_7': np.int64(9780), 'ATR_norm_lag_7': np.int64(9780)}
2025-10-29 16:11:09 - data_processing - ERROR - log_validation_result:165 - ❌ Filtered Data validation failed
2025-10-29 16:11:09 - data_processing - ERROR - __main__:351 - ❌ Pipeline failed: A4_filtered contains 4005700 NaN values in columns: {'MA_7_norm_lag_1': np.int64(9780), 'close_vs_lagging_span_pct_lag_7': np.int64(9780), 'is_doji_lag_7': np.int64(9780), 'is_engulfing_lag_7': np.int64(9780), 'is_hangingman_lag_7': np.int64(9780), 'is_hammer_lag_7': np.int64(9780), 'band_width_pct_lag_7': np.int64(9780), 'band_width_lag_7': np.int64(9780), 'ATR_norm_ma_lag_7': np.int64(9780), 'ATR_norm_lag_7': np.int64(9780)}
2025-10-29 16:11:09 - data_processing - ERROR - __main__:352 - Full traceback:
Traceback (most recent call last):
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 335, in __main__
    validate_filtered_data(A0_filtered, A1_filtered, A2_filtered,
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                           A3_filtered, A4_filtered, A5_filtered)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 248, in validate_filtered_data
    validate_filtered_features(A4_filtered,
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
                               "A4_filtered",
                               ^^^^^^^^^^^^^^
                               start=pd.to_datetime(TRAIN_START),
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                               end=pd.to_datetime(TEST_END),
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                               drop_head_rows=12)
                               ^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/validation/feature_validation.py", line 110, in validate_filtered_features
    raise ValueError(error_msg)
ValueError: A4_filtered contains 4005700 NaN values in columns: {'MA_7_norm_lag_1': np.int64(9780), 'close_vs_lagging_span_pct_lag_7': np.int64(9780), 'is_doji_lag_7': np.int64(9780), 'is_engulfing_lag_7': np.int64(9780), 'is_hangingman_lag_7': np.int64(9780), 'is_hammer_lag_7': np.int64(9780), 'band_width_pct_lag_7': np.int64(9780), 'band_width_lag_7': np.int64(9780), 'ATR_norm_ma_lag_7': np.int64(9780), 'ATR_norm_lag_7': np.int64(9780)}
2025-10-29 16:16:11 - data_processing.validation.feature_validation - ERROR - validate_filtered_features:109 - ❌ A4_filtered contains 4005700 NaN values in columns: {'MA_7_norm_lag_1': np.int64(9780), 'close_vs_lagging_span_pct_lag_7': np.int64(9780), 'is_doji_lag_7': np.int64(9780), 'is_engulfing_lag_7': np.int64(9780), 'is_hangingman_lag_7': np.int64(9780), 'is_hammer_lag_7': np.int64(9780), 'band_width_pct_lag_7': np.int64(9780), 'band_width_lag_7': np.int64(9780), 'ATR_norm_ma_lag_7': np.int64(9780), 'ATR_norm_lag_7': np.int64(9780)}
2025-10-29 16:16:11 - data_processing - ERROR - log_validation_result:165 - ❌ Filtered Data validation failed
2025-10-29 16:16:11 - data_processing - ERROR - __main__:351 - ❌ Pipeline failed: A4_filtered contains 4005700 NaN values in columns: {'MA_7_norm_lag_1': np.int64(9780), 'close_vs_lagging_span_pct_lag_7': np.int64(9780), 'is_doji_lag_7': np.int64(9780), 'is_engulfing_lag_7': np.int64(9780), 'is_hangingman_lag_7': np.int64(9780), 'is_hammer_lag_7': np.int64(9780), 'band_width_pct_lag_7': np.int64(9780), 'band_width_lag_7': np.int64(9780), 'ATR_norm_ma_lag_7': np.int64(9780), 'ATR_norm_lag_7': np.int64(9780)}
2025-10-29 16:16:11 - data_processing - ERROR - __main__:352 - Full traceback:
Traceback (most recent call last):
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 335, in __main__
    validate_filtered_data(A0_filtered, A1_filtered, A2_filtered,
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                           A3_filtered, A4_filtered, A5_filtered)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 248, in validate_filtered_data
    validate_filtered_features(A4_filtered,
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
                               "A4_filtered",
                               ^^^^^^^^^^^^^^
                               start=pd.to_datetime(TRAIN_START),
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                               end=pd.to_datetime(TEST_END),
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                               drop_head_rows=12)
                               ^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/validation/feature_validation.py", line 110, in validate_filtered_features
    raise ValueError(error_msg)
ValueError: A4_filtered contains 4005700 NaN values in columns: {'MA_7_norm_lag_1': np.int64(9780), 'close_vs_lagging_span_pct_lag_7': np.int64(9780), 'is_doji_lag_7': np.int64(9780), 'is_engulfing_lag_7': np.int64(9780), 'is_hangingman_lag_7': np.int64(9780), 'is_hammer_lag_7': np.int64(9780), 'band_width_pct_lag_7': np.int64(9780), 'band_width_lag_7': np.int64(9780), 'ATR_norm_ma_lag_7': np.int64(9780), 'ATR_norm_lag_7': np.int64(9780)}
2025-10-29 16:19:58 - data_processing.validation.feature_validation - ERROR - validate_filtered_features:109 - ❌ A4_filtered contains 4005700 NaN values in columns: {'MA_7_norm_lag_1': np.int64(9780), 'close_vs_lagging_span_pct_lag_7': np.int64(9780), 'is_doji_lag_7': np.int64(9780), 'is_engulfing_lag_7': np.int64(9780), 'is_hangingman_lag_7': np.int64(9780), 'is_hammer_lag_7': np.int64(9780), 'band_width_pct_lag_7': np.int64(9780), 'band_width_lag_7': np.int64(9780), 'ATR_norm_ma_lag_7': np.int64(9780), 'ATR_norm_lag_7': np.int64(9780)}
2025-10-29 16:19:58 - data_processing - ERROR - log_validation_result:165 - ❌ Filtered Data validation failed
2025-10-29 16:19:58 - data_processing - ERROR - __main__:351 - ❌ Pipeline failed: A4_filtered contains 4005700 NaN values in columns: {'MA_7_norm_lag_1': np.int64(9780), 'close_vs_lagging_span_pct_lag_7': np.int64(9780), 'is_doji_lag_7': np.int64(9780), 'is_engulfing_lag_7': np.int64(9780), 'is_hangingman_lag_7': np.int64(9780), 'is_hammer_lag_7': np.int64(9780), 'band_width_pct_lag_7': np.int64(9780), 'band_width_lag_7': np.int64(9780), 'ATR_norm_ma_lag_7': np.int64(9780), 'ATR_norm_lag_7': np.int64(9780)}
2025-10-29 16:19:58 - data_processing - ERROR - __main__:352 - Full traceback:
Traceback (most recent call last):
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 335, in __main__
    validate_filtered_data(A0_filtered, A1_filtered, A2_filtered,
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                           A3_filtered, A4_filtered, A5_filtered)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 248, in validate_filtered_data
    validate_filtered_features(A4_filtered,
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
                               "A4_filtered",
                               ^^^^^^^^^^^^^^
                               start=pd.to_datetime(TRAIN_START),
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                               end=pd.to_datetime(TEST_END),
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                               drop_head_rows=12)
                               ^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/validation/feature_validation.py", line 110, in validate_filtered_features
    raise ValueError(error_msg)
ValueError: A4_filtered contains 4005700 NaN values in columns: {'MA_7_norm_lag_1': np.int64(9780), 'close_vs_lagging_span_pct_lag_7': np.int64(9780), 'is_doji_lag_7': np.int64(9780), 'is_engulfing_lag_7': np.int64(9780), 'is_hangingman_lag_7': np.int64(9780), 'is_hammer_lag_7': np.int64(9780), 'band_width_pct_lag_7': np.int64(9780), 'band_width_lag_7': np.int64(9780), 'ATR_norm_ma_lag_7': np.int64(9780), 'ATR_norm_lag_7': np.int64(9780)}
2025-10-29 16:22:46 - data_processing.validation.feature_validation - ERROR - validate_filtered_features:109 - ❌ A4_filtered contains 4005700 NaN values in columns: {'MA_7_norm_lag_1': np.int64(9780), 'close_vs_lagging_span_pct_lag_7': np.int64(9780), 'is_doji_lag_7': np.int64(9780), 'is_engulfing_lag_7': np.int64(9780), 'is_hangingman_lag_7': np.int64(9780), 'is_hammer_lag_7': np.int64(9780), 'band_width_pct_lag_7': np.int64(9780), 'band_width_lag_7': np.int64(9780), 'ATR_norm_ma_lag_7': np.int64(9780), 'ATR_norm_lag_7': np.int64(9780)}
2025-10-29 16:22:46 - data_processing - ERROR - log_validation_result:165 - ❌ Filtered Data validation failed
2025-10-29 16:22:46 - data_processing - ERROR - __main__:347 - ❌ Pipeline failed: A4_filtered contains 4005700 NaN values in columns: {'MA_7_norm_lag_1': np.int64(9780), 'close_vs_lagging_span_pct_lag_7': np.int64(9780), 'is_doji_lag_7': np.int64(9780), 'is_engulfing_lag_7': np.int64(9780), 'is_hangingman_lag_7': np.int64(9780), 'is_hammer_lag_7': np.int64(9780), 'band_width_pct_lag_7': np.int64(9780), 'band_width_lag_7': np.int64(9780), 'ATR_norm_ma_lag_7': np.int64(9780), 'ATR_norm_lag_7': np.int64(9780)}
2025-10-29 16:22:46 - data_processing - ERROR - __main__:348 - Full traceback:
Traceback (most recent call last):
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 331, in __main__
    validate_filtered_data(A0_filtered, A1_filtered, A2_filtered,
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                           A3_filtered, A4_filtered, A5_filtered)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 244, in validate_filtered_data
    validate_filtered_features(A4_filtered,
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
                               "A4_filtered",
                               ^^^^^^^^^^^^^^
                               start=pd.to_datetime(TRAIN_START),
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                               end=pd.to_datetime(TEST_END),
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                               drop_head_rows=12)
                               ^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/validation/feature_validation.py", line 110, in validate_filtered_features
    raise ValueError(error_msg)
ValueError: A4_filtered contains 4005700 NaN values in columns: {'MA_7_norm_lag_1': np.int64(9780), 'close_vs_lagging_span_pct_lag_7': np.int64(9780), 'is_doji_lag_7': np.int64(9780), 'is_engulfing_lag_7': np.int64(9780), 'is_hangingman_lag_7': np.int64(9780), 'is_hammer_lag_7': np.int64(9780), 'band_width_pct_lag_7': np.int64(9780), 'band_width_lag_7': np.int64(9780), 'ATR_norm_ma_lag_7': np.int64(9780), 'ATR_norm_lag_7': np.int64(9780)}
2025-10-29 16:29:47 - data_processing - ERROR - log_validation_result:165 - ❌ Filtered Data validation failed
2025-10-29 16:29:47 - data_processing - ERROR - __main__:347 - ❌ Pipeline failed: cannot reindex on an axis with duplicate labels
2025-10-29 16:29:47 - data_processing - ERROR - __main__:348 - Full traceback:
Traceback (most recent call last):
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 331, in __main__
    validate_filtered_data(A0_filtered, A1_filtered, A2_filtered,
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                           A3_filtered, A4_filtered, A5_filtered)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 244, in validate_filtered_data
    validate_filtered_features(A4_filtered,
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
                               "A4_filtered",
                               ^^^^^^^^^^^^^^
                               start=pd.to_datetime(TRAIN_START),
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                               end=pd.to_datetime(TEST_END),
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                               drop_head_rows=12)
                               ^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/validation/feature_validation.py", line 131, in validate_filtered_features
    nan_indices = df_view[df_view[col].isnull()].index[:5].tolist()
                  ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/core/frame.py", line 4100, in __getitem__
    return self.where(key)
           ~~~~~~~~~~^^^^^
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/core/generic.py", line 11048, in where
    return self._where(cond, other, inplace, axis, level)
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/core/generic.py", line 10748, in _where
    cond = cond.reindex(self._info_axis, axis=self._info_axis_number, copy=False)
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/core/frame.py", line 5400, in reindex
    return super().reindex(
           ~~~~~~~~~~~~~~~^
        labels=labels,
        ^^^^^^^^^^^^^^
    ...<8 lines>...
        tolerance=tolerance,
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/core/generic.py", line 5632, in reindex
    return self._reindex_axes(
           ~~~~~~~~~~~~~~~~~~^
        axes, level, limit, tolerance, method, fill_value, copy
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ).__finalize__(self, method="reindex")
    ^
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/core/generic.py", line 5655, in _reindex_axes
    new_index, indexer = ax.reindex(
                         ~~~~~~~~~~^
        labels, level=level, limit=limit, tolerance=tolerance, method=method
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/anaconda3/envs/csml/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 4436, in reindex
    raise ValueError("cannot reindex on an axis with duplicate labels")
ValueError: cannot reindex on an axis with duplicate labels
2025-10-29 16:34:26 - data_processing.validation.feature_validation - ERROR - validate_filtered_features:126 - ❌ A4_filtered has duplicate columns: ['MA_7_norm_lag_1', 'MA_14_norm_lag_1', 'MA_20_norm_lag_1', 'MA_60_norm_lag_1', 'MA_120_norm_lag_1', 'MA_7_MA_14_norm_lag_1', 'MA_7_MA_20_norm_lag_1', 'MA_7_MA_60_norm_lag_1', 'MA_7_MA_120_norm_lag_1', 'MA_14_MA_20_norm_lag_1', 'MA_14_MA_60_norm_lag_1', 'MA_14_MA_120_norm_lag_1', 'MA_20_MA_60_norm_lag_1', 'MA_20_MA_120_norm_lag_1', 'MA_60_MA_120_norm_lag_1', 'RSI_lag_1', 'MACD_line_lag_1', 'MACD_signal_lag_1', 'MACD_histogram_lag_1', 'close_vs_conversion_line_pct_lag_1', 'close_vs_baseline_pct_lag_1', 'close_vs_leading_span_A_pct_lag_1', 'close_vs_leading_span_B_pct_lag_1', 'close_vs_lagging_span_pct_lag_1', 'conversion_vs_baseline_pct_lag_1', 'span_A_vs_span_B_pct_lag_1', 'ATR_norm_lag_1', 'ATR_norm_ma_lag_1', 'band_width_lag_1', 'band_width_pct_lag_1', 'is_hammer_lag_1', 'is_hangingman_lag_1', 'is_engulfing_lag_1', 'is_doji_lag_1', 'is_eveningstar_lag_1', 'volume_vs_volume_MA_20_pct_lag_1', 'volume_change_pct_lag_1', 'candle_body_pct_lag_1', 'high_wick_pct_lag_1', 'low_wick_pct_lag_1', 'range_pct_lag_1', 'MA_7_norm_lag_2', 'MA_14_norm_lag_2', 'MA_20_norm_lag_2', 'MA_60_norm_lag_2', 'MA_120_norm_lag_2', 'MA_7_MA_14_norm_lag_2', 'MA_7_MA_20_norm_lag_2', 'MA_7_MA_60_norm_lag_2', 'MA_7_MA_120_norm_lag_2', 'MA_14_MA_20_norm_lag_2', 'MA_14_MA_60_norm_lag_2', 'MA_14_MA_120_norm_lag_2', 'MA_20_MA_60_norm_lag_2', 'MA_20_MA_120_norm_lag_2', 'MA_60_MA_120_norm_lag_2', 'RSI_lag_2', 'MACD_line_lag_2', 'MACD_signal_lag_2', 'MACD_histogram_lag_2', 'close_vs_conversion_line_pct_lag_2', 'close_vs_baseline_pct_lag_2', 'close_vs_leading_span_A_pct_lag_2', 'close_vs_leading_span_B_pct_lag_2', 'close_vs_lagging_span_pct_lag_2', 'conversion_vs_baseline_pct_lag_2', 'span_A_vs_span_B_pct_lag_2', 'ATR_norm_lag_2', 'ATR_norm_ma_lag_2', 'band_width_lag_2', 'band_width_pct_lag_2', 'is_hammer_lag_2', 'is_hangingman_lag_2', 'is_engulfing_lag_2', 'is_doji_lag_2', 'is_eveningstar_lag_2', 'volume_vs_volume_MA_20_pct_lag_2', 'volume_change_pct_lag_2', 'candle_body_pct_lag_2', 'high_wick_pct_lag_2', 'low_wick_pct_lag_2', 'range_pct_lag_2', 'MA_7_norm_lag_3', 'MA_14_norm_lag_3', 'MA_20_norm_lag_3', 'MA_60_norm_lag_3', 'MA_120_norm_lag_3', 'MA_7_MA_14_norm_lag_3', 'MA_7_MA_20_norm_lag_3', 'MA_7_MA_60_norm_lag_3', 'MA_7_MA_120_norm_lag_3', 'MA_14_MA_20_norm_lag_3', 'MA_14_MA_60_norm_lag_3', 'MA_14_MA_120_norm_lag_3', 'MA_20_MA_60_norm_lag_3', 'MA_20_MA_120_norm_lag_3', 'MA_60_MA_120_norm_lag_3', 'RSI_lag_3', 'MACD_line_lag_3', 'MACD_signal_lag_3', 'MACD_histogram_lag_3', 'close_vs_conversion_line_pct_lag_3', 'close_vs_baseline_pct_lag_3', 'close_vs_leading_span_A_pct_lag_3', 'close_vs_leading_span_B_pct_lag_3', 'close_vs_lagging_span_pct_lag_3', 'conversion_vs_baseline_pct_lag_3', 'span_A_vs_span_B_pct_lag_3', 'ATR_norm_lag_3', 'ATR_norm_ma_lag_3', 'band_width_lag_3', 'band_width_pct_lag_3', 'is_hammer_lag_3', 'is_hangingman_lag_3', 'is_engulfing_lag_3', 'is_doji_lag_3', 'is_eveningstar_lag_3', 'volume_vs_volume_MA_20_pct_lag_3', 'volume_change_pct_lag_3', 'candle_body_pct_lag_3', 'high_wick_pct_lag_3', 'low_wick_pct_lag_3', 'range_pct_lag_3', 'MA_7_norm_lag_4', 'MA_14_norm_lag_4', 'MA_20_norm_lag_4', 'MA_60_norm_lag_4', 'MA_120_norm_lag_4', 'MA_7_MA_14_norm_lag_4', 'MA_7_MA_20_norm_lag_4', 'MA_7_MA_60_norm_lag_4', 'MA_7_MA_120_norm_lag_4', 'MA_14_MA_20_norm_lag_4', 'MA_14_MA_60_norm_lag_4', 'MA_14_MA_120_norm_lag_4', 'MA_20_MA_60_norm_lag_4', 'MA_20_MA_120_norm_lag_4', 'MA_60_MA_120_norm_lag_4', 'RSI_lag_4', 'MACD_line_lag_4', 'MACD_signal_lag_4', 'MACD_histogram_lag_4', 'close_vs_conversion_line_pct_lag_4', 'close_vs_baseline_pct_lag_4', 'close_vs_leading_span_A_pct_lag_4', 'close_vs_leading_span_B_pct_lag_4', 'close_vs_lagging_span_pct_lag_4', 'conversion_vs_baseline_pct_lag_4', 'span_A_vs_span_B_pct_lag_4', 'ATR_norm_lag_4', 'ATR_norm_ma_lag_4', 'band_width_lag_4', 'band_width_pct_lag_4', 'is_hammer_lag_4', 'is_hangingman_lag_4', 'is_engulfing_lag_4', 'is_doji_lag_4', 'is_eveningstar_lag_4', 'volume_vs_volume_MA_20_pct_lag_4', 'volume_change_pct_lag_4', 'candle_body_pct_lag_4', 'high_wick_pct_lag_4', 'low_wick_pct_lag_4', 'range_pct_lag_4', 'MA_7_norm_lag_5', 'MA_14_norm_lag_5', 'MA_20_norm_lag_5', 'MA_60_norm_lag_5', 'MA_120_norm_lag_5', 'MA_7_MA_14_norm_lag_5', 'MA_7_MA_20_norm_lag_5', 'MA_7_MA_60_norm_lag_5', 'MA_7_MA_120_norm_lag_5', 'MA_14_MA_20_norm_lag_5', 'MA_14_MA_60_norm_lag_5', 'MA_14_MA_120_norm_lag_5', 'MA_20_MA_60_norm_lag_5', 'MA_20_MA_120_norm_lag_5', 'MA_60_MA_120_norm_lag_5', 'RSI_lag_5', 'MACD_line_lag_5', 'MACD_signal_lag_5', 'MACD_histogram_lag_5', 'close_vs_conversion_line_pct_lag_5', 'close_vs_baseline_pct_lag_5', 'close_vs_leading_span_A_pct_lag_5', 'close_vs_leading_span_B_pct_lag_5', 'close_vs_lagging_span_pct_lag_5', 'conversion_vs_baseline_pct_lag_5', 'span_A_vs_span_B_pct_lag_5', 'ATR_norm_lag_5', 'ATR_norm_ma_lag_5', 'band_width_lag_5', 'band_width_pct_lag_5', 'is_hammer_lag_5', 'is_hangingman_lag_5', 'is_engulfing_lag_5', 'is_doji_lag_5', 'is_eveningstar_lag_5', 'volume_vs_volume_MA_20_pct_lag_5', 'volume_change_pct_lag_5', 'candle_body_pct_lag_5', 'high_wick_pct_lag_5', 'low_wick_pct_lag_5', 'range_pct_lag_5', 'MA_7_norm_lag_6', 'MA_14_norm_lag_6', 'MA_20_norm_lag_6', 'MA_60_norm_lag_6', 'MA_120_norm_lag_6', 'MA_7_MA_14_norm_lag_6', 'MA_7_MA_20_norm_lag_6', 'MA_7_MA_60_norm_lag_6', 'MA_7_MA_120_norm_lag_6', 'MA_14_MA_20_norm_lag_6', 'MA_14_MA_60_norm_lag_6', 'MA_14_MA_120_norm_lag_6', 'MA_20_MA_60_norm_lag_6', 'MA_20_MA_120_norm_lag_6', 'MA_60_MA_120_norm_lag_6', 'RSI_lag_6', 'MACD_line_lag_6', 'MACD_signal_lag_6', 'MACD_histogram_lag_6', 'close_vs_conversion_line_pct_lag_6', 'close_vs_baseline_pct_lag_6', 'close_vs_leading_span_A_pct_lag_6', 'close_vs_leading_span_B_pct_lag_6', 'close_vs_lagging_span_pct_lag_6', 'conversion_vs_baseline_pct_lag_6', 'span_A_vs_span_B_pct_lag_6', 'ATR_norm_lag_6', 'ATR_norm_ma_lag_6', 'band_width_lag_6', 'band_width_pct_lag_6', 'is_hammer_lag_6', 'is_hangingman_lag_6', 'is_engulfing_lag_6', 'is_doji_lag_6', 'is_eveningstar_lag_6', 'volume_vs_volume_MA_20_pct_lag_6', 'volume_change_pct_lag_6', 'candle_body_pct_lag_6', 'high_wick_pct_lag_6', 'low_wick_pct_lag_6', 'range_pct_lag_6', 'MA_7_norm_lag_7', 'MA_14_norm_lag_7', 'MA_20_norm_lag_7', 'MA_60_norm_lag_7', 'MA_120_norm_lag_7', 'MA_7_MA_14_norm_lag_7', 'MA_7_MA_20_norm_lag_7', 'MA_7_MA_60_norm_lag_7', 'MA_7_MA_120_norm_lag_7', 'MA_14_MA_20_norm_lag_7', 'MA_14_MA_60_norm_lag_7', 'MA_14_MA_120_norm_lag_7', 'MA_20_MA_60_norm_lag_7', 'MA_20_MA_120_norm_lag_7', 'MA_60_MA_120_norm_lag_7', 'RSI_lag_7', 'MACD_line_lag_7', 'MACD_signal_lag_7', 'MACD_histogram_lag_7', 'close_vs_conversion_line_pct_lag_7', 'close_vs_baseline_pct_lag_7', 'close_vs_leading_span_A_pct_lag_7', 'close_vs_leading_span_B_pct_lag_7', 'close_vs_lagging_span_pct_lag_7', 'conversion_vs_baseline_pct_lag_7', 'span_A_vs_span_B_pct_lag_7', 'ATR_norm_lag_7', 'ATR_norm_ma_lag_7', 'band_width_lag_7', 'band_width_pct_lag_7', 'is_hammer_lag_7', 'is_hangingman_lag_7', 'is_engulfing_lag_7', 'is_doji_lag_7', 'is_eveningstar_lag_7', 'volume_vs_volume_MA_20_pct_lag_7', 'volume_change_pct_lag_7', 'candle_body_pct_lag_7', 'high_wick_pct_lag_7', 'low_wick_pct_lag_7', 'range_pct_lag_7', 'MA_7_norm_lag_8', 'MA_14_norm_lag_8', 'MA_20_norm_lag_8', 'MA_60_norm_lag_8', 'MA_120_norm_lag_8', 'MA_7_MA_14_norm_lag_8', 'MA_7_MA_20_norm_lag_8', 'MA_7_MA_60_norm_lag_8', 'MA_7_MA_120_norm_lag_8', 'MA_14_MA_20_norm_lag_8', 'MA_14_MA_60_norm_lag_8', 'MA_14_MA_120_norm_lag_8', 'MA_20_MA_60_norm_lag_8', 'MA_20_MA_120_norm_lag_8', 'MA_60_MA_120_norm_lag_8', 'RSI_lag_8', 'MACD_line_lag_8', 'MACD_signal_lag_8', 'MACD_histogram_lag_8', 'close_vs_conversion_line_pct_lag_8', 'close_vs_baseline_pct_lag_8', 'close_vs_leading_span_A_pct_lag_8', 'close_vs_leading_span_B_pct_lag_8', 'close_vs_lagging_span_pct_lag_8', 'conversion_vs_baseline_pct_lag_8', 'span_A_vs_span_B_pct_lag_8', 'ATR_norm_lag_8', 'ATR_norm_ma_lag_8', 'band_width_lag_8', 'band_width_pct_lag_8', 'is_hammer_lag_8', 'is_hangingman_lag_8', 'is_engulfing_lag_8', 'is_doji_lag_8', 'is_eveningstar_lag_8', 'volume_vs_volume_MA_20_pct_lag_8', 'volume_change_pct_lag_8', 'candle_body_pct_lag_8', 'high_wick_pct_lag_8', 'low_wick_pct_lag_8', 'range_pct_lag_8', 'MA_7_norm_lag_9', 'MA_14_norm_lag_9', 'MA_20_norm_lag_9', 'MA_60_norm_lag_9', 'MA_120_norm_lag_9', 'MA_7_MA_14_norm_lag_9', 'MA_7_MA_20_norm_lag_9', 'MA_7_MA_60_norm_lag_9', 'MA_7_MA_120_norm_lag_9', 'MA_14_MA_20_norm_lag_9', 'MA_14_MA_60_norm_lag_9', 'MA_14_MA_120_norm_lag_9', 'MA_20_MA_60_norm_lag_9', 'MA_20_MA_120_norm_lag_9', 'MA_60_MA_120_norm_lag_9', 'RSI_lag_9', 'MACD_line_lag_9', 'MACD_signal_lag_9', 'MACD_histogram_lag_9', 'close_vs_conversion_line_pct_lag_9', 'close_vs_baseline_pct_lag_9', 'close_vs_leading_span_A_pct_lag_9', 'close_vs_leading_span_B_pct_lag_9', 'close_vs_lagging_span_pct_lag_9', 'conversion_vs_baseline_pct_lag_9', 'span_A_vs_span_B_pct_lag_9', 'ATR_norm_lag_9', 'ATR_norm_ma_lag_9', 'band_width_lag_9', 'band_width_pct_lag_9', 'is_hammer_lag_9', 'is_hangingman_lag_9', 'is_engulfing_lag_9', 'is_doji_lag_9', 'is_eveningstar_lag_9', 'volume_vs_volume_MA_20_pct_lag_9', 'volume_change_pct_lag_9', 'candle_body_pct_lag_9', 'high_wick_pct_lag_9', 'low_wick_pct_lag_9', 'range_pct_lag_9', 'MA_7_norm_lag_10', 'MA_14_norm_lag_10', 'MA_20_norm_lag_10', 'MA_60_norm_lag_10', 'MA_120_norm_lag_10', 'MA_7_MA_14_norm_lag_10', 'MA_7_MA_20_norm_lag_10', 'MA_7_MA_60_norm_lag_10', 'MA_7_MA_120_norm_lag_10', 'MA_14_MA_20_norm_lag_10', 'MA_14_MA_60_norm_lag_10', 'MA_14_MA_120_norm_lag_10', 'MA_20_MA_60_norm_lag_10', 'MA_20_MA_120_norm_lag_10', 'MA_60_MA_120_norm_lag_10', 'RSI_lag_10', 'MACD_line_lag_10', 'MACD_signal_lag_10', 'MACD_histogram_lag_10', 'close_vs_conversion_line_pct_lag_10', 'close_vs_baseline_pct_lag_10', 'close_vs_leading_span_A_pct_lag_10', 'close_vs_leading_span_B_pct_lag_10', 'close_vs_lagging_span_pct_lag_10', 'conversion_vs_baseline_pct_lag_10', 'span_A_vs_span_B_pct_lag_10', 'ATR_norm_lag_10', 'ATR_norm_ma_lag_10', 'band_width_lag_10', 'band_width_pct_lag_10', 'is_hammer_lag_10', 'is_hangingman_lag_10', 'is_engulfing_lag_10', 'is_doji_lag_10', 'is_eveningstar_lag_10', 'volume_vs_volume_MA_20_pct_lag_10', 'volume_change_pct_lag_10', 'candle_body_pct_lag_10', 'high_wick_pct_lag_10', 'low_wick_pct_lag_10', 'range_pct_lag_10']
2025-10-29 16:34:26 - data_processing - ERROR - log_validation_result:165 - ❌ Filtered Data validation failed
2025-10-29 16:34:26 - data_processing - ERROR - __main__:347 - ❌ Pipeline failed: A4_filtered has duplicate columns: ['MA_7_norm_lag_1', 'MA_14_norm_lag_1', 'MA_20_norm_lag_1', 'MA_60_norm_lag_1', 'MA_120_norm_lag_1', 'MA_7_MA_14_norm_lag_1', 'MA_7_MA_20_norm_lag_1', 'MA_7_MA_60_norm_lag_1', 'MA_7_MA_120_norm_lag_1', 'MA_14_MA_20_norm_lag_1', 'MA_14_MA_60_norm_lag_1', 'MA_14_MA_120_norm_lag_1', 'MA_20_MA_60_norm_lag_1', 'MA_20_MA_120_norm_lag_1', 'MA_60_MA_120_norm_lag_1', 'RSI_lag_1', 'MACD_line_lag_1', 'MACD_signal_lag_1', 'MACD_histogram_lag_1', 'close_vs_conversion_line_pct_lag_1', 'close_vs_baseline_pct_lag_1', 'close_vs_leading_span_A_pct_lag_1', 'close_vs_leading_span_B_pct_lag_1', 'close_vs_lagging_span_pct_lag_1', 'conversion_vs_baseline_pct_lag_1', 'span_A_vs_span_B_pct_lag_1', 'ATR_norm_lag_1', 'ATR_norm_ma_lag_1', 'band_width_lag_1', 'band_width_pct_lag_1', 'is_hammer_lag_1', 'is_hangingman_lag_1', 'is_engulfing_lag_1', 'is_doji_lag_1', 'is_eveningstar_lag_1', 'volume_vs_volume_MA_20_pct_lag_1', 'volume_change_pct_lag_1', 'candle_body_pct_lag_1', 'high_wick_pct_lag_1', 'low_wick_pct_lag_1', 'range_pct_lag_1', 'MA_7_norm_lag_2', 'MA_14_norm_lag_2', 'MA_20_norm_lag_2', 'MA_60_norm_lag_2', 'MA_120_norm_lag_2', 'MA_7_MA_14_norm_lag_2', 'MA_7_MA_20_norm_lag_2', 'MA_7_MA_60_norm_lag_2', 'MA_7_MA_120_norm_lag_2', 'MA_14_MA_20_norm_lag_2', 'MA_14_MA_60_norm_lag_2', 'MA_14_MA_120_norm_lag_2', 'MA_20_MA_60_norm_lag_2', 'MA_20_MA_120_norm_lag_2', 'MA_60_MA_120_norm_lag_2', 'RSI_lag_2', 'MACD_line_lag_2', 'MACD_signal_lag_2', 'MACD_histogram_lag_2', 'close_vs_conversion_line_pct_lag_2', 'close_vs_baseline_pct_lag_2', 'close_vs_leading_span_A_pct_lag_2', 'close_vs_leading_span_B_pct_lag_2', 'close_vs_lagging_span_pct_lag_2', 'conversion_vs_baseline_pct_lag_2', 'span_A_vs_span_B_pct_lag_2', 'ATR_norm_lag_2', 'ATR_norm_ma_lag_2', 'band_width_lag_2', 'band_width_pct_lag_2', 'is_hammer_lag_2', 'is_hangingman_lag_2', 'is_engulfing_lag_2', 'is_doji_lag_2', 'is_eveningstar_lag_2', 'volume_vs_volume_MA_20_pct_lag_2', 'volume_change_pct_lag_2', 'candle_body_pct_lag_2', 'high_wick_pct_lag_2', 'low_wick_pct_lag_2', 'range_pct_lag_2', 'MA_7_norm_lag_3', 'MA_14_norm_lag_3', 'MA_20_norm_lag_3', 'MA_60_norm_lag_3', 'MA_120_norm_lag_3', 'MA_7_MA_14_norm_lag_3', 'MA_7_MA_20_norm_lag_3', 'MA_7_MA_60_norm_lag_3', 'MA_7_MA_120_norm_lag_3', 'MA_14_MA_20_norm_lag_3', 'MA_14_MA_60_norm_lag_3', 'MA_14_MA_120_norm_lag_3', 'MA_20_MA_60_norm_lag_3', 'MA_20_MA_120_norm_lag_3', 'MA_60_MA_120_norm_lag_3', 'RSI_lag_3', 'MACD_line_lag_3', 'MACD_signal_lag_3', 'MACD_histogram_lag_3', 'close_vs_conversion_line_pct_lag_3', 'close_vs_baseline_pct_lag_3', 'close_vs_leading_span_A_pct_lag_3', 'close_vs_leading_span_B_pct_lag_3', 'close_vs_lagging_span_pct_lag_3', 'conversion_vs_baseline_pct_lag_3', 'span_A_vs_span_B_pct_lag_3', 'ATR_norm_lag_3', 'ATR_norm_ma_lag_3', 'band_width_lag_3', 'band_width_pct_lag_3', 'is_hammer_lag_3', 'is_hangingman_lag_3', 'is_engulfing_lag_3', 'is_doji_lag_3', 'is_eveningstar_lag_3', 'volume_vs_volume_MA_20_pct_lag_3', 'volume_change_pct_lag_3', 'candle_body_pct_lag_3', 'high_wick_pct_lag_3', 'low_wick_pct_lag_3', 'range_pct_lag_3', 'MA_7_norm_lag_4', 'MA_14_norm_lag_4', 'MA_20_norm_lag_4', 'MA_60_norm_lag_4', 'MA_120_norm_lag_4', 'MA_7_MA_14_norm_lag_4', 'MA_7_MA_20_norm_lag_4', 'MA_7_MA_60_norm_lag_4', 'MA_7_MA_120_norm_lag_4', 'MA_14_MA_20_norm_lag_4', 'MA_14_MA_60_norm_lag_4', 'MA_14_MA_120_norm_lag_4', 'MA_20_MA_60_norm_lag_4', 'MA_20_MA_120_norm_lag_4', 'MA_60_MA_120_norm_lag_4', 'RSI_lag_4', 'MACD_line_lag_4', 'MACD_signal_lag_4', 'MACD_histogram_lag_4', 'close_vs_conversion_line_pct_lag_4', 'close_vs_baseline_pct_lag_4', 'close_vs_leading_span_A_pct_lag_4', 'close_vs_leading_span_B_pct_lag_4', 'close_vs_lagging_span_pct_lag_4', 'conversion_vs_baseline_pct_lag_4', 'span_A_vs_span_B_pct_lag_4', 'ATR_norm_lag_4', 'ATR_norm_ma_lag_4', 'band_width_lag_4', 'band_width_pct_lag_4', 'is_hammer_lag_4', 'is_hangingman_lag_4', 'is_engulfing_lag_4', 'is_doji_lag_4', 'is_eveningstar_lag_4', 'volume_vs_volume_MA_20_pct_lag_4', 'volume_change_pct_lag_4', 'candle_body_pct_lag_4', 'high_wick_pct_lag_4', 'low_wick_pct_lag_4', 'range_pct_lag_4', 'MA_7_norm_lag_5', 'MA_14_norm_lag_5', 'MA_20_norm_lag_5', 'MA_60_norm_lag_5', 'MA_120_norm_lag_5', 'MA_7_MA_14_norm_lag_5', 'MA_7_MA_20_norm_lag_5', 'MA_7_MA_60_norm_lag_5', 'MA_7_MA_120_norm_lag_5', 'MA_14_MA_20_norm_lag_5', 'MA_14_MA_60_norm_lag_5', 'MA_14_MA_120_norm_lag_5', 'MA_20_MA_60_norm_lag_5', 'MA_20_MA_120_norm_lag_5', 'MA_60_MA_120_norm_lag_5', 'RSI_lag_5', 'MACD_line_lag_5', 'MACD_signal_lag_5', 'MACD_histogram_lag_5', 'close_vs_conversion_line_pct_lag_5', 'close_vs_baseline_pct_lag_5', 'close_vs_leading_span_A_pct_lag_5', 'close_vs_leading_span_B_pct_lag_5', 'close_vs_lagging_span_pct_lag_5', 'conversion_vs_baseline_pct_lag_5', 'span_A_vs_span_B_pct_lag_5', 'ATR_norm_lag_5', 'ATR_norm_ma_lag_5', 'band_width_lag_5', 'band_width_pct_lag_5', 'is_hammer_lag_5', 'is_hangingman_lag_5', 'is_engulfing_lag_5', 'is_doji_lag_5', 'is_eveningstar_lag_5', 'volume_vs_volume_MA_20_pct_lag_5', 'volume_change_pct_lag_5', 'candle_body_pct_lag_5', 'high_wick_pct_lag_5', 'low_wick_pct_lag_5', 'range_pct_lag_5', 'MA_7_norm_lag_6', 'MA_14_norm_lag_6', 'MA_20_norm_lag_6', 'MA_60_norm_lag_6', 'MA_120_norm_lag_6', 'MA_7_MA_14_norm_lag_6', 'MA_7_MA_20_norm_lag_6', 'MA_7_MA_60_norm_lag_6', 'MA_7_MA_120_norm_lag_6', 'MA_14_MA_20_norm_lag_6', 'MA_14_MA_60_norm_lag_6', 'MA_14_MA_120_norm_lag_6', 'MA_20_MA_60_norm_lag_6', 'MA_20_MA_120_norm_lag_6', 'MA_60_MA_120_norm_lag_6', 'RSI_lag_6', 'MACD_line_lag_6', 'MACD_signal_lag_6', 'MACD_histogram_lag_6', 'close_vs_conversion_line_pct_lag_6', 'close_vs_baseline_pct_lag_6', 'close_vs_leading_span_A_pct_lag_6', 'close_vs_leading_span_B_pct_lag_6', 'close_vs_lagging_span_pct_lag_6', 'conversion_vs_baseline_pct_lag_6', 'span_A_vs_span_B_pct_lag_6', 'ATR_norm_lag_6', 'ATR_norm_ma_lag_6', 'band_width_lag_6', 'band_width_pct_lag_6', 'is_hammer_lag_6', 'is_hangingman_lag_6', 'is_engulfing_lag_6', 'is_doji_lag_6', 'is_eveningstar_lag_6', 'volume_vs_volume_MA_20_pct_lag_6', 'volume_change_pct_lag_6', 'candle_body_pct_lag_6', 'high_wick_pct_lag_6', 'low_wick_pct_lag_6', 'range_pct_lag_6', 'MA_7_norm_lag_7', 'MA_14_norm_lag_7', 'MA_20_norm_lag_7', 'MA_60_norm_lag_7', 'MA_120_norm_lag_7', 'MA_7_MA_14_norm_lag_7', 'MA_7_MA_20_norm_lag_7', 'MA_7_MA_60_norm_lag_7', 'MA_7_MA_120_norm_lag_7', 'MA_14_MA_20_norm_lag_7', 'MA_14_MA_60_norm_lag_7', 'MA_14_MA_120_norm_lag_7', 'MA_20_MA_60_norm_lag_7', 'MA_20_MA_120_norm_lag_7', 'MA_60_MA_120_norm_lag_7', 'RSI_lag_7', 'MACD_line_lag_7', 'MACD_signal_lag_7', 'MACD_histogram_lag_7', 'close_vs_conversion_line_pct_lag_7', 'close_vs_baseline_pct_lag_7', 'close_vs_leading_span_A_pct_lag_7', 'close_vs_leading_span_B_pct_lag_7', 'close_vs_lagging_span_pct_lag_7', 'conversion_vs_baseline_pct_lag_7', 'span_A_vs_span_B_pct_lag_7', 'ATR_norm_lag_7', 'ATR_norm_ma_lag_7', 'band_width_lag_7', 'band_width_pct_lag_7', 'is_hammer_lag_7', 'is_hangingman_lag_7', 'is_engulfing_lag_7', 'is_doji_lag_7', 'is_eveningstar_lag_7', 'volume_vs_volume_MA_20_pct_lag_7', 'volume_change_pct_lag_7', 'candle_body_pct_lag_7', 'high_wick_pct_lag_7', 'low_wick_pct_lag_7', 'range_pct_lag_7', 'MA_7_norm_lag_8', 'MA_14_norm_lag_8', 'MA_20_norm_lag_8', 'MA_60_norm_lag_8', 'MA_120_norm_lag_8', 'MA_7_MA_14_norm_lag_8', 'MA_7_MA_20_norm_lag_8', 'MA_7_MA_60_norm_lag_8', 'MA_7_MA_120_norm_lag_8', 'MA_14_MA_20_norm_lag_8', 'MA_14_MA_60_norm_lag_8', 'MA_14_MA_120_norm_lag_8', 'MA_20_MA_60_norm_lag_8', 'MA_20_MA_120_norm_lag_8', 'MA_60_MA_120_norm_lag_8', 'RSI_lag_8', 'MACD_line_lag_8', 'MACD_signal_lag_8', 'MACD_histogram_lag_8', 'close_vs_conversion_line_pct_lag_8', 'close_vs_baseline_pct_lag_8', 'close_vs_leading_span_A_pct_lag_8', 'close_vs_leading_span_B_pct_lag_8', 'close_vs_lagging_span_pct_lag_8', 'conversion_vs_baseline_pct_lag_8', 'span_A_vs_span_B_pct_lag_8', 'ATR_norm_lag_8', 'ATR_norm_ma_lag_8', 'band_width_lag_8', 'band_width_pct_lag_8', 'is_hammer_lag_8', 'is_hangingman_lag_8', 'is_engulfing_lag_8', 'is_doji_lag_8', 'is_eveningstar_lag_8', 'volume_vs_volume_MA_20_pct_lag_8', 'volume_change_pct_lag_8', 'candle_body_pct_lag_8', 'high_wick_pct_lag_8', 'low_wick_pct_lag_8', 'range_pct_lag_8', 'MA_7_norm_lag_9', 'MA_14_norm_lag_9', 'MA_20_norm_lag_9', 'MA_60_norm_lag_9', 'MA_120_norm_lag_9', 'MA_7_MA_14_norm_lag_9', 'MA_7_MA_20_norm_lag_9', 'MA_7_MA_60_norm_lag_9', 'MA_7_MA_120_norm_lag_9', 'MA_14_MA_20_norm_lag_9', 'MA_14_MA_60_norm_lag_9', 'MA_14_MA_120_norm_lag_9', 'MA_20_MA_60_norm_lag_9', 'MA_20_MA_120_norm_lag_9', 'MA_60_MA_120_norm_lag_9', 'RSI_lag_9', 'MACD_line_lag_9', 'MACD_signal_lag_9', 'MACD_histogram_lag_9', 'close_vs_conversion_line_pct_lag_9', 'close_vs_baseline_pct_lag_9', 'close_vs_leading_span_A_pct_lag_9', 'close_vs_leading_span_B_pct_lag_9', 'close_vs_lagging_span_pct_lag_9', 'conversion_vs_baseline_pct_lag_9', 'span_A_vs_span_B_pct_lag_9', 'ATR_norm_lag_9', 'ATR_norm_ma_lag_9', 'band_width_lag_9', 'band_width_pct_lag_9', 'is_hammer_lag_9', 'is_hangingman_lag_9', 'is_engulfing_lag_9', 'is_doji_lag_9', 'is_eveningstar_lag_9', 'volume_vs_volume_MA_20_pct_lag_9', 'volume_change_pct_lag_9', 'candle_body_pct_lag_9', 'high_wick_pct_lag_9', 'low_wick_pct_lag_9', 'range_pct_lag_9', 'MA_7_norm_lag_10', 'MA_14_norm_lag_10', 'MA_20_norm_lag_10', 'MA_60_norm_lag_10', 'MA_120_norm_lag_10', 'MA_7_MA_14_norm_lag_10', 'MA_7_MA_20_norm_lag_10', 'MA_7_MA_60_norm_lag_10', 'MA_7_MA_120_norm_lag_10', 'MA_14_MA_20_norm_lag_10', 'MA_14_MA_60_norm_lag_10', 'MA_14_MA_120_norm_lag_10', 'MA_20_MA_60_norm_lag_10', 'MA_20_MA_120_norm_lag_10', 'MA_60_MA_120_norm_lag_10', 'RSI_lag_10', 'MACD_line_lag_10', 'MACD_signal_lag_10', 'MACD_histogram_lag_10', 'close_vs_conversion_line_pct_lag_10', 'close_vs_baseline_pct_lag_10', 'close_vs_leading_span_A_pct_lag_10', 'close_vs_leading_span_B_pct_lag_10', 'close_vs_lagging_span_pct_lag_10', 'conversion_vs_baseline_pct_lag_10', 'span_A_vs_span_B_pct_lag_10', 'ATR_norm_lag_10', 'ATR_norm_ma_lag_10', 'band_width_lag_10', 'band_width_pct_lag_10', 'is_hammer_lag_10', 'is_hangingman_lag_10', 'is_engulfing_lag_10', 'is_doji_lag_10', 'is_eveningstar_lag_10', 'volume_vs_volume_MA_20_pct_lag_10', 'volume_change_pct_lag_10', 'candle_body_pct_lag_10', 'high_wick_pct_lag_10', 'low_wick_pct_lag_10', 'range_pct_lag_10']
2025-10-29 16:34:26 - data_processing - ERROR - __main__:348 - Full traceback:
Traceback (most recent call last):
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 331, in __main__
    validate_filtered_data(A0_filtered, A1_filtered, A2_filtered,
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                           A3_filtered, A4_filtered, A5_filtered)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 244, in validate_filtered_data
    validate_filtered_features(A4_filtered,
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
                               "A4_filtered",
                               ^^^^^^^^^^^^^^
                               start=pd.to_datetime(TRAIN_START),
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                               end=pd.to_datetime(TEST_END),
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                               drop_head_rows=12)
                               ^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/validation/feature_validation.py", line 127, in validate_filtered_features
    raise ValueError(error_msg)
ValueError: A4_filtered has duplicate columns: ['MA_7_norm_lag_1', 'MA_14_norm_lag_1', 'MA_20_norm_lag_1', 'MA_60_norm_lag_1', 'MA_120_norm_lag_1', 'MA_7_MA_14_norm_lag_1', 'MA_7_MA_20_norm_lag_1', 'MA_7_MA_60_norm_lag_1', 'MA_7_MA_120_norm_lag_1', 'MA_14_MA_20_norm_lag_1', 'MA_14_MA_60_norm_lag_1', 'MA_14_MA_120_norm_lag_1', 'MA_20_MA_60_norm_lag_1', 'MA_20_MA_120_norm_lag_1', 'MA_60_MA_120_norm_lag_1', 'RSI_lag_1', 'MACD_line_lag_1', 'MACD_signal_lag_1', 'MACD_histogram_lag_1', 'close_vs_conversion_line_pct_lag_1', 'close_vs_baseline_pct_lag_1', 'close_vs_leading_span_A_pct_lag_1', 'close_vs_leading_span_B_pct_lag_1', 'close_vs_lagging_span_pct_lag_1', 'conversion_vs_baseline_pct_lag_1', 'span_A_vs_span_B_pct_lag_1', 'ATR_norm_lag_1', 'ATR_norm_ma_lag_1', 'band_width_lag_1', 'band_width_pct_lag_1', 'is_hammer_lag_1', 'is_hangingman_lag_1', 'is_engulfing_lag_1', 'is_doji_lag_1', 'is_eveningstar_lag_1', 'volume_vs_volume_MA_20_pct_lag_1', 'volume_change_pct_lag_1', 'candle_body_pct_lag_1', 'high_wick_pct_lag_1', 'low_wick_pct_lag_1', 'range_pct_lag_1', 'MA_7_norm_lag_2', 'MA_14_norm_lag_2', 'MA_20_norm_lag_2', 'MA_60_norm_lag_2', 'MA_120_norm_lag_2', 'MA_7_MA_14_norm_lag_2', 'MA_7_MA_20_norm_lag_2', 'MA_7_MA_60_norm_lag_2', 'MA_7_MA_120_norm_lag_2', 'MA_14_MA_20_norm_lag_2', 'MA_14_MA_60_norm_lag_2', 'MA_14_MA_120_norm_lag_2', 'MA_20_MA_60_norm_lag_2', 'MA_20_MA_120_norm_lag_2', 'MA_60_MA_120_norm_lag_2', 'RSI_lag_2', 'MACD_line_lag_2', 'MACD_signal_lag_2', 'MACD_histogram_lag_2', 'close_vs_conversion_line_pct_lag_2', 'close_vs_baseline_pct_lag_2', 'close_vs_leading_span_A_pct_lag_2', 'close_vs_leading_span_B_pct_lag_2', 'close_vs_lagging_span_pct_lag_2', 'conversion_vs_baseline_pct_lag_2', 'span_A_vs_span_B_pct_lag_2', 'ATR_norm_lag_2', 'ATR_norm_ma_lag_2', 'band_width_lag_2', 'band_width_pct_lag_2', 'is_hammer_lag_2', 'is_hangingman_lag_2', 'is_engulfing_lag_2', 'is_doji_lag_2', 'is_eveningstar_lag_2', 'volume_vs_volume_MA_20_pct_lag_2', 'volume_change_pct_lag_2', 'candle_body_pct_lag_2', 'high_wick_pct_lag_2', 'low_wick_pct_lag_2', 'range_pct_lag_2', 'MA_7_norm_lag_3', 'MA_14_norm_lag_3', 'MA_20_norm_lag_3', 'MA_60_norm_lag_3', 'MA_120_norm_lag_3', 'MA_7_MA_14_norm_lag_3', 'MA_7_MA_20_norm_lag_3', 'MA_7_MA_60_norm_lag_3', 'MA_7_MA_120_norm_lag_3', 'MA_14_MA_20_norm_lag_3', 'MA_14_MA_60_norm_lag_3', 'MA_14_MA_120_norm_lag_3', 'MA_20_MA_60_norm_lag_3', 'MA_20_MA_120_norm_lag_3', 'MA_60_MA_120_norm_lag_3', 'RSI_lag_3', 'MACD_line_lag_3', 'MACD_signal_lag_3', 'MACD_histogram_lag_3', 'close_vs_conversion_line_pct_lag_3', 'close_vs_baseline_pct_lag_3', 'close_vs_leading_span_A_pct_lag_3', 'close_vs_leading_span_B_pct_lag_3', 'close_vs_lagging_span_pct_lag_3', 'conversion_vs_baseline_pct_lag_3', 'span_A_vs_span_B_pct_lag_3', 'ATR_norm_lag_3', 'ATR_norm_ma_lag_3', 'band_width_lag_3', 'band_width_pct_lag_3', 'is_hammer_lag_3', 'is_hangingman_lag_3', 'is_engulfing_lag_3', 'is_doji_lag_3', 'is_eveningstar_lag_3', 'volume_vs_volume_MA_20_pct_lag_3', 'volume_change_pct_lag_3', 'candle_body_pct_lag_3', 'high_wick_pct_lag_3', 'low_wick_pct_lag_3', 'range_pct_lag_3', 'MA_7_norm_lag_4', 'MA_14_norm_lag_4', 'MA_20_norm_lag_4', 'MA_60_norm_lag_4', 'MA_120_norm_lag_4', 'MA_7_MA_14_norm_lag_4', 'MA_7_MA_20_norm_lag_4', 'MA_7_MA_60_norm_lag_4', 'MA_7_MA_120_norm_lag_4', 'MA_14_MA_20_norm_lag_4', 'MA_14_MA_60_norm_lag_4', 'MA_14_MA_120_norm_lag_4', 'MA_20_MA_60_norm_lag_4', 'MA_20_MA_120_norm_lag_4', 'MA_60_MA_120_norm_lag_4', 'RSI_lag_4', 'MACD_line_lag_4', 'MACD_signal_lag_4', 'MACD_histogram_lag_4', 'close_vs_conversion_line_pct_lag_4', 'close_vs_baseline_pct_lag_4', 'close_vs_leading_span_A_pct_lag_4', 'close_vs_leading_span_B_pct_lag_4', 'close_vs_lagging_span_pct_lag_4', 'conversion_vs_baseline_pct_lag_4', 'span_A_vs_span_B_pct_lag_4', 'ATR_norm_lag_4', 'ATR_norm_ma_lag_4', 'band_width_lag_4', 'band_width_pct_lag_4', 'is_hammer_lag_4', 'is_hangingman_lag_4', 'is_engulfing_lag_4', 'is_doji_lag_4', 'is_eveningstar_lag_4', 'volume_vs_volume_MA_20_pct_lag_4', 'volume_change_pct_lag_4', 'candle_body_pct_lag_4', 'high_wick_pct_lag_4', 'low_wick_pct_lag_4', 'range_pct_lag_4', 'MA_7_norm_lag_5', 'MA_14_norm_lag_5', 'MA_20_norm_lag_5', 'MA_60_norm_lag_5', 'MA_120_norm_lag_5', 'MA_7_MA_14_norm_lag_5', 'MA_7_MA_20_norm_lag_5', 'MA_7_MA_60_norm_lag_5', 'MA_7_MA_120_norm_lag_5', 'MA_14_MA_20_norm_lag_5', 'MA_14_MA_60_norm_lag_5', 'MA_14_MA_120_norm_lag_5', 'MA_20_MA_60_norm_lag_5', 'MA_20_MA_120_norm_lag_5', 'MA_60_MA_120_norm_lag_5', 'RSI_lag_5', 'MACD_line_lag_5', 'MACD_signal_lag_5', 'MACD_histogram_lag_5', 'close_vs_conversion_line_pct_lag_5', 'close_vs_baseline_pct_lag_5', 'close_vs_leading_span_A_pct_lag_5', 'close_vs_leading_span_B_pct_lag_5', 'close_vs_lagging_span_pct_lag_5', 'conversion_vs_baseline_pct_lag_5', 'span_A_vs_span_B_pct_lag_5', 'ATR_norm_lag_5', 'ATR_norm_ma_lag_5', 'band_width_lag_5', 'band_width_pct_lag_5', 'is_hammer_lag_5', 'is_hangingman_lag_5', 'is_engulfing_lag_5', 'is_doji_lag_5', 'is_eveningstar_lag_5', 'volume_vs_volume_MA_20_pct_lag_5', 'volume_change_pct_lag_5', 'candle_body_pct_lag_5', 'high_wick_pct_lag_5', 'low_wick_pct_lag_5', 'range_pct_lag_5', 'MA_7_norm_lag_6', 'MA_14_norm_lag_6', 'MA_20_norm_lag_6', 'MA_60_norm_lag_6', 'MA_120_norm_lag_6', 'MA_7_MA_14_norm_lag_6', 'MA_7_MA_20_norm_lag_6', 'MA_7_MA_60_norm_lag_6', 'MA_7_MA_120_norm_lag_6', 'MA_14_MA_20_norm_lag_6', 'MA_14_MA_60_norm_lag_6', 'MA_14_MA_120_norm_lag_6', 'MA_20_MA_60_norm_lag_6', 'MA_20_MA_120_norm_lag_6', 'MA_60_MA_120_norm_lag_6', 'RSI_lag_6', 'MACD_line_lag_6', 'MACD_signal_lag_6', 'MACD_histogram_lag_6', 'close_vs_conversion_line_pct_lag_6', 'close_vs_baseline_pct_lag_6', 'close_vs_leading_span_A_pct_lag_6', 'close_vs_leading_span_B_pct_lag_6', 'close_vs_lagging_span_pct_lag_6', 'conversion_vs_baseline_pct_lag_6', 'span_A_vs_span_B_pct_lag_6', 'ATR_norm_lag_6', 'ATR_norm_ma_lag_6', 'band_width_lag_6', 'band_width_pct_lag_6', 'is_hammer_lag_6', 'is_hangingman_lag_6', 'is_engulfing_lag_6', 'is_doji_lag_6', 'is_eveningstar_lag_6', 'volume_vs_volume_MA_20_pct_lag_6', 'volume_change_pct_lag_6', 'candle_body_pct_lag_6', 'high_wick_pct_lag_6', 'low_wick_pct_lag_6', 'range_pct_lag_6', 'MA_7_norm_lag_7', 'MA_14_norm_lag_7', 'MA_20_norm_lag_7', 'MA_60_norm_lag_7', 'MA_120_norm_lag_7', 'MA_7_MA_14_norm_lag_7', 'MA_7_MA_20_norm_lag_7', 'MA_7_MA_60_norm_lag_7', 'MA_7_MA_120_norm_lag_7', 'MA_14_MA_20_norm_lag_7', 'MA_14_MA_60_norm_lag_7', 'MA_14_MA_120_norm_lag_7', 'MA_20_MA_60_norm_lag_7', 'MA_20_MA_120_norm_lag_7', 'MA_60_MA_120_norm_lag_7', 'RSI_lag_7', 'MACD_line_lag_7', 'MACD_signal_lag_7', 'MACD_histogram_lag_7', 'close_vs_conversion_line_pct_lag_7', 'close_vs_baseline_pct_lag_7', 'close_vs_leading_span_A_pct_lag_7', 'close_vs_leading_span_B_pct_lag_7', 'close_vs_lagging_span_pct_lag_7', 'conversion_vs_baseline_pct_lag_7', 'span_A_vs_span_B_pct_lag_7', 'ATR_norm_lag_7', 'ATR_norm_ma_lag_7', 'band_width_lag_7', 'band_width_pct_lag_7', 'is_hammer_lag_7', 'is_hangingman_lag_7', 'is_engulfing_lag_7', 'is_doji_lag_7', 'is_eveningstar_lag_7', 'volume_vs_volume_MA_20_pct_lag_7', 'volume_change_pct_lag_7', 'candle_body_pct_lag_7', 'high_wick_pct_lag_7', 'low_wick_pct_lag_7', 'range_pct_lag_7', 'MA_7_norm_lag_8', 'MA_14_norm_lag_8', 'MA_20_norm_lag_8', 'MA_60_norm_lag_8', 'MA_120_norm_lag_8', 'MA_7_MA_14_norm_lag_8', 'MA_7_MA_20_norm_lag_8', 'MA_7_MA_60_norm_lag_8', 'MA_7_MA_120_norm_lag_8', 'MA_14_MA_20_norm_lag_8', 'MA_14_MA_60_norm_lag_8', 'MA_14_MA_120_norm_lag_8', 'MA_20_MA_60_norm_lag_8', 'MA_20_MA_120_norm_lag_8', 'MA_60_MA_120_norm_lag_8', 'RSI_lag_8', 'MACD_line_lag_8', 'MACD_signal_lag_8', 'MACD_histogram_lag_8', 'close_vs_conversion_line_pct_lag_8', 'close_vs_baseline_pct_lag_8', 'close_vs_leading_span_A_pct_lag_8', 'close_vs_leading_span_B_pct_lag_8', 'close_vs_lagging_span_pct_lag_8', 'conversion_vs_baseline_pct_lag_8', 'span_A_vs_span_B_pct_lag_8', 'ATR_norm_lag_8', 'ATR_norm_ma_lag_8', 'band_width_lag_8', 'band_width_pct_lag_8', 'is_hammer_lag_8', 'is_hangingman_lag_8', 'is_engulfing_lag_8', 'is_doji_lag_8', 'is_eveningstar_lag_8', 'volume_vs_volume_MA_20_pct_lag_8', 'volume_change_pct_lag_8', 'candle_body_pct_lag_8', 'high_wick_pct_lag_8', 'low_wick_pct_lag_8', 'range_pct_lag_8', 'MA_7_norm_lag_9', 'MA_14_norm_lag_9', 'MA_20_norm_lag_9', 'MA_60_norm_lag_9', 'MA_120_norm_lag_9', 'MA_7_MA_14_norm_lag_9', 'MA_7_MA_20_norm_lag_9', 'MA_7_MA_60_norm_lag_9', 'MA_7_MA_120_norm_lag_9', 'MA_14_MA_20_norm_lag_9', 'MA_14_MA_60_norm_lag_9', 'MA_14_MA_120_norm_lag_9', 'MA_20_MA_60_norm_lag_9', 'MA_20_MA_120_norm_lag_9', 'MA_60_MA_120_norm_lag_9', 'RSI_lag_9', 'MACD_line_lag_9', 'MACD_signal_lag_9', 'MACD_histogram_lag_9', 'close_vs_conversion_line_pct_lag_9', 'close_vs_baseline_pct_lag_9', 'close_vs_leading_span_A_pct_lag_9', 'close_vs_leading_span_B_pct_lag_9', 'close_vs_lagging_span_pct_lag_9', 'conversion_vs_baseline_pct_lag_9', 'span_A_vs_span_B_pct_lag_9', 'ATR_norm_lag_9', 'ATR_norm_ma_lag_9', 'band_width_lag_9', 'band_width_pct_lag_9', 'is_hammer_lag_9', 'is_hangingman_lag_9', 'is_engulfing_lag_9', 'is_doji_lag_9', 'is_eveningstar_lag_9', 'volume_vs_volume_MA_20_pct_lag_9', 'volume_change_pct_lag_9', 'candle_body_pct_lag_9', 'high_wick_pct_lag_9', 'low_wick_pct_lag_9', 'range_pct_lag_9', 'MA_7_norm_lag_10', 'MA_14_norm_lag_10', 'MA_20_norm_lag_10', 'MA_60_norm_lag_10', 'MA_120_norm_lag_10', 'MA_7_MA_14_norm_lag_10', 'MA_7_MA_20_norm_lag_10', 'MA_7_MA_60_norm_lag_10', 'MA_7_MA_120_norm_lag_10', 'MA_14_MA_20_norm_lag_10', 'MA_14_MA_60_norm_lag_10', 'MA_14_MA_120_norm_lag_10', 'MA_20_MA_60_norm_lag_10', 'MA_20_MA_120_norm_lag_10', 'MA_60_MA_120_norm_lag_10', 'RSI_lag_10', 'MACD_line_lag_10', 'MACD_signal_lag_10', 'MACD_histogram_lag_10', 'close_vs_conversion_line_pct_lag_10', 'close_vs_baseline_pct_lag_10', 'close_vs_leading_span_A_pct_lag_10', 'close_vs_leading_span_B_pct_lag_10', 'close_vs_lagging_span_pct_lag_10', 'conversion_vs_baseline_pct_lag_10', 'span_A_vs_span_B_pct_lag_10', 'ATR_norm_lag_10', 'ATR_norm_ma_lag_10', 'band_width_lag_10', 'band_width_pct_lag_10', 'is_hammer_lag_10', 'is_hangingman_lag_10', 'is_engulfing_lag_10', 'is_doji_lag_10', 'is_eveningstar_lag_10', 'volume_vs_volume_MA_20_pct_lag_10', 'volume_change_pct_lag_10', 'candle_body_pct_lag_10', 'high_wick_pct_lag_10', 'low_wick_pct_lag_10', 'range_pct_lag_10']
2025-10-29 16:36:18 - data_processing.validation.feature_validation - ERROR - validate_filtered_features:142 - ❌ A4_filtered contains 4005700 NaN values. First 5 NaN indices per column: {'MA_7_norm_lag_D1_1': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'close_vs_lagging_span_pct_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'is_doji_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'is_engulfing_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'is_hangingman_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')]}
2025-10-29 16:36:18 - data_processing - ERROR - log_validation_result:165 - ❌ Filtered Data validation failed
2025-10-29 16:36:18 - data_processing - ERROR - __main__:347 - ❌ Pipeline failed: A4_filtered contains 4005700 NaN values. First 5 NaN indices per column: {'MA_7_norm_lag_D1_1': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'close_vs_lagging_span_pct_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'is_doji_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'is_engulfing_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'is_hangingman_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')]}
2025-10-29 16:36:18 - data_processing - ERROR - __main__:348 - Full traceback:
Traceback (most recent call last):
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 331, in __main__
    validate_filtered_data(A0_filtered, A1_filtered, A2_filtered,
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                           A3_filtered, A4_filtered, A5_filtered)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 244, in validate_filtered_data
    validate_filtered_features(A4_filtered,
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
                               "A4_filtered",
                               ^^^^^^^^^^^^^^
                               start=pd.to_datetime(TRAIN_START),
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                               end=pd.to_datetime(TEST_END),
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                               drop_head_rows=12)
                               ^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/validation/feature_validation.py", line 143, in validate_filtered_features
    raise ValueError(error_msg)
ValueError: A4_filtered contains 4005700 NaN values. First 5 NaN indices per column: {'MA_7_norm_lag_D1_1': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'close_vs_lagging_span_pct_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'is_doji_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'is_engulfing_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'is_hangingman_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')]}
2025-10-29 16:39:56 - data_processing - ERROR - __main__:348 - ❌ Pipeline failed: cannot construct a Timedelta from the passed arguments, allowed keywords are [weeks, days, hours, minutes, seconds, milliseconds, microseconds, nanoseconds]
2025-10-29 16:39:56 - data_processing - ERROR - __main__:349 - Full traceback:
Traceback (most recent call last):
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 317, in __main__
    A0, A1, A2 = align_timeframe(df_h4, df_d1, df_w1)
                 ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 112, in align_timeframe
    pd.Timedelta(week=4),
    ~~~~~~~~~~~~^^^^^^^^
  File "pandas/_libs/tslibs/timedeltas.pyx", line 1782, in pandas._libs.tslibs.timedeltas.Timedelta.__new__
ValueError: cannot construct a Timedelta from the passed arguments, allowed keywords are [weeks, days, hours, minutes, seconds, milliseconds, microseconds, nanoseconds]
2025-10-29 16:40:27 - data_processing.validation.feature_validation - ERROR - validate_filtered_features:142 - ❌ A4_filtered contains 4005700 NaN values. First 5 NaN indices per column: {'MA_7_norm_lag_D1_1': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'close_vs_lagging_span_pct_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'is_doji_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'is_engulfing_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'is_hangingman_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')]}
2025-10-29 16:40:27 - data_processing - ERROR - log_validation_result:165 - ❌ Filtered Data validation failed
2025-10-29 16:40:27 - data_processing - ERROR - __main__:348 - ❌ Pipeline failed: A4_filtered contains 4005700 NaN values. First 5 NaN indices per column: {'MA_7_norm_lag_D1_1': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'close_vs_lagging_span_pct_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'is_doji_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'is_engulfing_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'is_hangingman_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')]}
2025-10-29 16:40:27 - data_processing - ERROR - __main__:349 - Full traceback:
Traceback (most recent call last):
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 332, in __main__
    validate_filtered_data(A0_filtered, A1_filtered, A2_filtered,
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                           A3_filtered, A4_filtered, A5_filtered)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 245, in validate_filtered_data
    validate_filtered_features(A4_filtered,
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
                               "A4_filtered",
                               ^^^^^^^^^^^^^^
                               start=pd.to_datetime(TRAIN_START),
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                               end=pd.to_datetime(TEST_END),
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                               drop_head_rows=12)
                               ^^^^^^^^^^^^^^^^^^
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/validation/feature_validation.py", line 143, in validate_filtered_features
    raise ValueError(error_msg)
ValueError: A4_filtered contains 4005700 NaN values. First 5 NaN indices per column: {'MA_7_norm_lag_D1_1': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'close_vs_lagging_span_pct_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'is_doji_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'is_engulfing_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')], 'is_hangingman_lag_D1_7': [Timestamp('2020-05-14 04:00:00'), Timestamp('2020-05-14 08:00:00'), Timestamp('2020-05-14 12:00:00'), Timestamp('2020-05-14 16:00:00'), Timestamp('2020-05-14 20:00:00')]}
2025-10-29 19:40:32 - data_processing - ERROR - __main__:382 - ❌ Pipeline failed: not enough values to unpack (expected 8, got 6)
2025-10-29 19:40:32 - data_processing - ERROR - __main__:383 - Full traceback:
Traceback (most recent call last):
  File "/Users/al02260279/Documents/private/btc_prediction/data_processing/main_pipeline.py", line 361, in __main__
    A0_filtered, A1_filtered, A2_filtered, A3_filtered, A4_filtered, A5_filtered, A6_filtered, A7_filtered = filter_data(
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 8, got 6)
